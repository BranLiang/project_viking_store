<div class="user">
  <div class="top-section">
    <h2>Viking Store Users</h2>
    <%= button_to "Create New User", new_user_path, class: "btn btn-primary btn-lg" %>
  </div>
  <div class="table-responsive">
    <table class="table table-striped table-bordered table-hover">
      <thead>
        <tr>
          <td>ID</td>
          <td>Name</td>
          <td>Joined</td>
          <td>City</td>
          <td>States</td>
          <td>Orders</td>
          <td>Last_Order_Date</td>
          <td>Show</td>
          <td>Edit</td>
          <td>Delete</td>
        </tr>
      </thead>
      <tbody>
        <% @users.each do |user| %>
        <tr>
          <td><%= user.id %></td>
          <td><%= "#{user.first_name} #{user.last_name}" %></td>
          <td><%= user.created_at.to_date %></td>
          <td><%= user.default_shipping_address.city.name %></td>
          <td><%= user.default_billing_address.state.name %></td>
          <td><%= link_to "#{user.orders.count}", '#' %></td>
          <% if user.orders.last %>
            <% if user.orders.last.checkout_date %>
              <td><%= user.orders.last.checkout_date.to_date %></td>
            <% else %>
              <td>In process</td>
            <% end %>
          <% else %>
            <td>No records</td>
          <% end %>
          <td><%= link_to "Show", user_path(user) %></td>
          <td><%= link_to "Edit", edit_user_path(user) %></td>
          <td><%= link_to "Delete", user_path(user), method: "delete" %></td>
        </tr>
        <% end %>
      </tbody>
    </table>
  </div>

</div>
